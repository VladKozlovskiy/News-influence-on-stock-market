# Исследование влияния новостей на предсказание активов.

## Мотивация

Часто можно услышать, что предсказывать цену актива бесполезно, т.к. по одной из гипотез финансовый рынок это мартингал, и лучшее предсказние его состояния &mdash; это нынешнее состояние. В этом репозитории будут приведены результаты проверки этой гипотезы, а также рассмотрены результаты предсказния других параметров активов. 

## Предсказание волатильности

### Шаги исследования

- [x] Была выполнена предобработка данных по активу компании `Tesla` за 2021-2022 год.
 
- [x] Протестировано применение двух разных вариантов эмбеддингов для кодирования новостей.

- [x] Последовательно добавлялись разные признаки для работы с временным рядом, после чего была выбрана лучшая модель.

- [x] Доказано положительное влияние новостей на предсказания с помощью статистического теста. 

 
### Основные выводы экспериментов с моделями

* Судя по предсказаниям, модели, использующие новости в принципе неплохо предсказывают динамику волатильности, однако предсказания сами по себе сильно смещены.

* Для применения модели к торговой стратегии достаточно важно понимать, как на фиксированном краткосрочном периоде поведет себя волатильность, т.е. хорошо аппроксимировать максимум и минмум волатильности  на отрезке. С таким смещением модели справятся с этой задачей плохо.

* Стоит оценивать качество по другой метрике, т.к. стандартные метрики не учитывают особенности второго пункта.

* Также стоит попробовать нейросетевой подход, чтобы иметь возможность делать несколько новых итераций `back propogation` на новых данных.

* Из полученных результатов сложно понять, повлияли ли новости на кач-во предсказания. Стоит сделать статистический тест.

### Основные выводы из статистического теста

* По метрике **MAPE**. Видно, что по классической метрике не получилось отвергнуть гипотезу (`p-value` $\approx 0.3$) о том, что новости являются полезным фактором для предсказания. Это ожидаемо исходя из того, что можно было наблюдать в экспериментах до этого, хоть они и были поставлены на бОльшем горизонте предсказания.

* По классической метрике виден результат. Очень уверенно (с `p-value` $\approx 7^{-8}$) отвергаем гипотезу о незначимости новостей. Видно, что отклонение предсказанного максимума от реального на 5% меньше, если использовать новости в работе.

* Было проведено два теста на одних и тех же данных. Как следствие, могла накопиться ошибка. Однако даже без применния продвинутых процедур МПГ можно видеть, что корректируя `p-value` даже с помощью метода Бонферрони результаты теста не меняются

### Более подбробное исследование

С более подробной версией исследования можно ознакомиться по [ссылке](https://github.com/VladKozlovskiy/News-influence-on-stock-market/blob/main/Volatility_forecasting.ipynb)


## TODO

* Добавить в репозиторий ноутбук по предсказнию тренда.

* Добавить ноутбук с результатами статистического теста. 

* Исследовать применение нейростевой модели предсказания или результатов из статьи, в которой коллеги пытались оптимизировать структуру деревьев исзодя из поступаемых данных.
